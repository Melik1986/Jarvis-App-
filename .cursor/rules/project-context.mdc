---
description: Контекст проекта JSRVIS 1C Mobile — цели, модули, стек, AI Adapter Pattern
globs: ["**/*"]
alwaysApply: true
---

# JSRVIS 1C Mobile — контекст проекта

## Цель

Мобильный AI-агент для управления бизнес-процессами в 1С (Universal AI ERP OS). Неструктурированный ввод (голос, фото, чат) → структурированные вызовы API 1С + аналитика через RAG.

## Модули

- **Jarvis Voice**: запись (expo-av), транскрипция (Whisper), выполнение команд.
- **Jarvis Vision**: анализ фото накладных/ценников (GPT-4o-mini) → автосоздание документов.
- **RAG (библиотекарь)**: поиск по инструкциям/регламентам в Qdrant.
- **Интегратор 1С**: прослойка Nest.js — авторизация, перевод намерений AI в OData/HTTP к 1С.

## Стек и требования

- Авторизация: Phone OTP (Supabase).
- Offline-first для остатков: Zustand + Persist.
- Стриминг ответов LLM: Vercel AI SDK.
- Структура: Monorepo-style. Сквозная типизация.

## AI Adapter Pattern

Абстрактный слой вместо кода под каждую систему (1С, МойСклад, Odoo, SAP).

- Настройки: URL, тип (REST/OData/GraphQL), API-ключ.
- Спецификация: пресет (напр. «1С:УНФ») или ссылка на Swagger/OpenAPI (JSON/YAML).
- LLM-маппинг: по спецификации API модель выбирает метод и параметры (напр. «остатки» → GET /v1/inventory, фильтр name).

## Бюджетная универсальность

1. **BYO-LLM**: экран Settings — Base URL, API Key, Model Name; Vercel AI SDK с подменой baseURL (OpenAI-compatible: Groq, Together, OpenRouter, Ollama).
2. **Универсальный ERP-коннектор**: бэкенд Nest.js парсит OpenAPI/Swagger, динамически генерирует Tools (Function Calling) для модели.
3. **MCP**: поддержка Model Context Protocol для подключения серверов (Sheets, PostgreSQL, ERP).

## Дополнительно

- Local-First: пресет Ollama — работа в закрытом контуре без облачных токенов.
- При реализации интеграций и подсказках по коду учитывать этот контекст.
