# Audit Exceptions

## ajv <8.18.0 (devDependencies)

- **Severity**: Moderate (ReDoS via `$data` option)
- **CVE**: [GHSA-2g4f-4pwh-qvx6](https://github.com/advisories/GHSA-2g4f-4pwh-qvx6)
- **Affected packages**:
  - `eslint@9.39.2` → `ajv@6.12.6`
  - `@eslint/eslintrc` → `ajv@6.12.6`
- **Reason for exception**:
  - ESLint 9.x requires `ajv@6.x` for JSON Schema draft-04 support
  - Upgrading to `ajv@8.x` breaks ESLint (incompatible schema validation)
  - No fix available without downgrading ESLint to v8.x (breaking change)
- **Risk assessment**:
  - **Dev-only dependency** — not exposed in production runtime
  - ReDoS requires malicious schema input to ESLint config (controlled environment)
  - Attack surface limited to development/CI environments
- **Mitigation**:
  - Production audit excludes devDependencies: `npm audit --omit=dev --audit-level=high`
  - CI pipeline configured to audit production dependencies only
  - ESLint config files are version-controlled and reviewed
- **Review date**: 2026-02-18
- **Next review**: When ESLint 10.x is released or `ajv@8.x` compatibility is added

---

## inflight@1.0.6 (devDependencies)

- **Severity**: Medium (CVSS 6.2)
- **CVE**: CWE-772 (Missing Release of Resource after Effective Lifetime)
- **Snyk ID**: [SNYK-JS-INFLIGHT-6095116](https://security.snyk.io/vuln/SNYK-JS-INFLIGHT-6095116)
- **Affected packages**:
  - `react-native@0.84.0` → `babel-jest@29.7.0` → `glob@7.2.3` → `inflight@1.0.6`
  - `expo@55.0.0-preview.11` → `@expo/cli@55.0.8` → `chromium-edge-launcher@0.2.0` → `rimraf@3.0.2` → `glob@7.2.3` → `inflight@1.0.6`
- **Reason for exception**:
  - **Library is unmaintained** — no active development or security patches
  - **Snyk verdict**: "No remediation path available"
  - Transitive dependency locked by `react-native@0.84.0` and `expo@55.0.0-preview.11`
  - `glob@13.x` (which removes `inflight`) cannot be forced due to deep dependency chains in babel-jest and chromium-edge-launcher
- **Risk assessment**:
  - **Dev-only dependency** — used in test toolchain (babel-jest) and dev middleware (chromium-edge-launcher)
  - **Attack vector: LOCAL** — requires physical/remote access to developer machine or CI runner
  - Exploiting this vulnerability requires ability to execute/influence asynchronous operations using `inflight` module
  - Does not process external user data; not exposed in production runtime
  - If attacker has local access, memory leak via `inflight` is not the primary security concern
- **Mitigation**:
  - Production audit excludes devDependencies: `npm audit --omit=dev --audit-level=high`
  - CI pipeline configured to audit production dependencies only
  - Monitor `react-native` and `expo` updates for removal of `glob@7.x` dependency
  - `glob@13.x` override applied globally, but deep transitive dependencies may still use `glob@7.x`
- **Review date**: 2026-02-18
- **Next review**: When `react-native` or `expo` stable releases eliminate `glob@7.x` dependency chain

---

## CI/CD Policy

Production security audit command:

```bash
npm audit --omit=dev --audit-level=high
```

This excludes devDependencies (like ESLint tooling) and focuses on runtime security.
